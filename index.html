<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZAMÓWIENIA SFP</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 5px; background: #fff; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        html { font-size: 120% !important;}
        /* NAGŁÓWEK GŁÓWNY (Excel Style) - ZAWSZE WIDOCZNY */
        #mainHeader th { background: #2c4d82; color: white; text-align: center; padding: 2px; font-size: 1.00rem; border: 1px solid #fff; }

        /* WIERSZE GŁÓWNE */
        .master-row td { border: 1px solid #ccc; padding: 12px 5px; text-align: center; font-size: 1.25rem; font-weight: bold; cursor: pointer; overflow: hidden; }         
        .row-type-1 { background-color: #ffffff; }
        .row-type-2 { background-color: #d9e1f2; }

        /* KOLORY STATUSÓW */
        .st-cell { color: white; text-transform: capitalize; }
        .st-started  { background-color: #10ac5c !important; }
        .st-released { background-color: #002060 !important; }
        .st-prepared { background-color: #00b0f0 !important; }
        .st-picking  { background-color: #555555  !important; color: white;}
        .st-picked   { background-color: #555555  !important; color: #808080;}

        /* SEKCJE ROZWIJANE */
        .detail-row { display: none; background: #fff; }
        /* .detail-cell { padding: 0 !important; border: 2px solid #333; } */
        .detail-cell { padding: 0 !important; }

        .extra-table, .inner-table { width: 100%; border-bottom: 1px solid #ccc; }
        .extra-table th, .inner-table th { background: #2c4d82; color: white; text-align: center; padding: 2px; font-size: 0.90rem; border: 1px solid #fff; } 
        .extra-table th:nth-child(1) { width: 10%; } 
        .extra-table th:nth-child(2) { width: 13%; } 
        .extra-table th:nth-child(3) { width: 13%; } 
        .extra-table th:nth-child(4) { width: 23%; } 
        .extra-table th:nth-child(5) { width: 8%; }
        .extra-table th:nth-child(6) { width: 14%; } 
        .extra-table th:nth-child(7) { width: 13%; } 
        .extra-table th:nth-child(8) { width: 6%; }
        .extra-table td, .inner-table td { border: 1px solid #ccc; padding: 2px 2px; text-align: center; font-size: 0.90rem; font-weight: normal; cursor: pointer; overflow: hidden; } 
        .inner-table th:nth-child(1) { width: 10%; } 
        .inner-table th:nth-child(2) { width: 38%; } 
        .inner-table td:nth-child(2) {font-size: 0.7rem; }
        .inner-table th:nth-child(3) { width: 9%; } 
        .inner-table th:nth-child(4) { width: 17%; } 
        .inner-table th:nth-child(5) { width: 13%; }
        .inner-table td:nth-child(5) {font-size: 0.7rem; }
        .inner-table th:nth-child(6) { width: 12%; } 
        .scroll-wrapper { overflow-x: auto; width: 100%; }


    </style>
</head>
<body>

<div id="container">
    <table>
        <thead id="mainHeader">
            <tr>
                <th style="width:9%">Time</th>
                <th style="width:14%">Status</th>
                <th style="width:19%">Center</th>
                <th style="width:18%">Product</th>
                <th style="width:8%">Qty</th>
                <th style="width:32%">Location</th>
            </tr>
        </thead>
        <tbody id="mainBody"></tbody>
    </table>
</div>

<script>
    const rawData = `Zlecenie;RelatedPO;R Order No;Start Date;Time;Status;POStatus;Center;Target Qty.;UOM;Product;Container;Quant;Location;LotNo;Expire
Komerc;103407846;000105323;17.02.2026 18:18:56;0:40;New;Started;A010;846.6;TH;33.B3ID;6000132600009996P2-511840933.B3IDB;132.6;DIM_RRP_OUT;P2-5118409;18.02.2026
;;000105323;;0:40;;;;;;33.B3ID;6000132600009996P2-511840933.B3IDB;132.6;DIM_RRP_OUT;P2-5118409;18.02.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602380005P2-546436633.B3IDB;264.6;P2_D_058;P2-5464366;24.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602380005P2-546436633.B3IDB;264.6;P2_D_058;P2-5464366;24.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602380006P2-546436633.B3IDB;78.4;P2_D_058;P2-5464366;24.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602380006P2-546436633.B3IDB;78.4;P2_D_058;P2-5464366;24.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-547277833.B3IDB;264.6;P2_A_227;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-547277833.B3IDB;264.6;P2_A_227;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-547277833.B3IDB;264.6;P2_A_204;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-547277833.B3IDB;264.6;P2_A_204;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000151901520016P2-547277833.B3IDB;264.6;P2_D_037;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000151901520016P2-547277833.B3IDB;264.6;P2_D_037;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650005P2-547277833.B3IDB;264.6;P2_A_228;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650005P2-547277833.B3IDB;264.6;P2_A_228;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650006P2-547277833.B3IDB;264.6;P2_A_231;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650006P2-547277833.B3IDB;264.6;P2_A_231;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-547277833.B3IDB;264.6;P2_A_257;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-547277833.B3IDB;264.6;P2_A_257;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-547277833.B3IDB;264.6;P2_A_269;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-547277833.B3IDB;264.6;P2_A_269;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650009P2-547277833.B3IDB;264.6;P2_A_255;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650009P2-547277833.B3IDB;264.6;P2_A_255;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650010P2-547277833.B3IDB;264.6;P2_A_254;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650010P2-547277833.B3IDB;264.6;P2_A_254;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650011P2-547277833.B3IDB;264.6;P2_A_233;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650011P2-547277833.B3IDB;264.6;P2_A_233;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650012P2-547277833.B3IDB;264.6;P2_D_004;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650012P2-547277833.B3IDB;264.6;P2_D_004;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650013P2-547277833.B3IDB;264.6;P2_D_021;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650013P2-547277833.B3IDB;264.6;P2_D_021;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650017P2-547277833.B3IDB;264.6;P2_A_239;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650017P2-547277833.B3IDB;264.6;P2_A_239;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000049000009999P2-547277833.B3IDB;49;P2_A_266;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000049000009999P2-547277833.B3IDB;49;P2_A_266;P2-5472778;31.05.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-547277933.B3IDB;264.6;P2_A_256;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-547277933.B3IDB;264.6;P2_A_256;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-547277933.B3IDB;264.6;P2_A_241;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-547277933.B3IDB;264.6;P2_A_241;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650006P2-547277933.B3IDB;264.6;P2_A_237;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650006P2-547277933.B3IDB;264.6;P2_A_237;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650005P2-547277933.B3IDB;264.6;P2_A_230;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650005P2-547277933.B3IDB;264.6;P2_A_230;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000171501720002P2-547277933.B3IDB;264.6;P2_A_264;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000171501720002P2-547277933.B3IDB;264.6;P2_A_264;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000063700640009P2-547277933.B3IDB;264.6;P2_A_265;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000063700640009P2-547277933.B3IDB;264.6;P2_A_265;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000083300830004P2-547277933.B3IDB;264.6;P2_A_259;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000083300830004P2-547277933.B3IDB;264.6;P2_A_259;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000117601180010P2-547277933.B3IDB;117.6;P2_A_260;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000117601180010P2-547277933.B3IDB;117.6;P2_A_260;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-547277933.B3IDB;264.6;P2_A_267;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-547277933.B3IDB;264.6;P2_A_267;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650001P2-547277933.B3IDB;264.6;P2_A_262;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650001P2-547277933.B3IDB;264.6;P2_A_262;P2-5472779;13.06.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-548687333.B3IDB;264.6;P2_A_283;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-548687333.B3IDB;264.6;P2_A_283;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-548687333.B3IDB;264.6;P2_A_282;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-548687333.B3IDB;264.6;P2_A_282;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000191101910005P2-548687333.B3IDB;191.1;P2_A_203;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000191101910005P2-548687333.B3IDB;191.1;P2_A_203;P2-5486873;07.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264600009999P2-548687433.B3IDB;264.6;P2_A_229;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264600009999P2-548687433.B3IDB;264.6;P2_A_229;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-548687433.B3IDB;264.6;P2_A_226;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650003P2-548687433.B3IDB;264.6;P2_A_226;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-548687433.B3IDB;264.6;P2_E_034;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650004P2-548687433.B3IDB;264.6;P2_E_034;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000073500740006P2-548687433.B3IDB;264.6;P2_E_024;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000073500740006P2-548687433.B3IDB;264.6;P2_E_024;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-548687433.B3IDB;264.6;P2_A_207;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650007P2-548687433.B3IDB;264.6;P2_A_207;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-548687433.B3IDB;264.6;P2_A_238;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650008P2-548687433.B3IDB;264.6;P2_A_238;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650011P2-548687433.B3IDB;264.6;P2_D_052;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650011P2-548687433.B3IDB;264.6;P2_D_052;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650012P2-548687433.B3IDB;264.6;P2_D_038;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000264602650012P2-548687433.B3IDB;264.6;P2_D_038;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000053900540013P2-548687433.B3IDB;53.9;P2_D_041;P2-5486874;20.07.2026
;;000105323;;0:40;;;;;;33.B3ID;6000053900540013P2-548687433.B3IDB;53.9;P2_D_041;P2-5486874;20.07.2026
Komerc;103390988;000105327;17.02.2026 18:44:45;0:14;New;Started;LU03;2.4;PC;47.0326;I470326000450414580301001;37;P1_D_007;23-L448798;03.12.2026
;;000105327;;0:14;;;;;;47.0326;I470326000450414580301002;35;P1_D_010;23-L448799;08.12.2026
Komerc;103390988;000105328;17.02.2026 18:45:02;0:13;New;Started;LU03;46.1;KG;80.A153;I80A153000450414556401001;429;P1_D_006;23-L447232;18.05.2026
;;000105328;;0:13;;;;;;80.A153;I80A153000450415551701901;110;P1_D_027;23-L448866;12.06.2026
Komerc;103387166;000105317;17.02.2026 16:50:05;2:08;New;Prepared;REP9977;1.3;TH;59.1155;I591155005450417095401001;3.6;P1_F_113;23-L449575;16.01.2027
Komerc;103387166;000105318;17.02.2026 16:50:05;2:08;New;Prepared;REP8200;520;TH;ME007482.05;010541070694331320081125120710PF08104934;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105033;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105134;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105234;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105334;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105434;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105534;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105636;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105736;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105836;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08105936;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110036;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110136;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110244;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110344;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110445;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110545;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110645;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110745;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110845;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08110944;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111045;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111351;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111512;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111647;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111746;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111846;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08111947;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112047;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112151;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112254;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112352;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112453;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112653;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112753;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112853;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08112948;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113036;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113123;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113213;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113301;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113353;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113454;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113553;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113654;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113756;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113856;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08113957;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08114112;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08114216;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08114336;10;P1_F_028_FG;PF-5474810;05.12.2026
;;000105318;;2:08;;;;;;ME007482.05;010541070694331320081125120710PF08114545;10;P1_F_028_FG;PF-5474810;05.12.2026
Komerc;103396282;000105287;17.02.2026 13:42:48;5:16;Picked;Started;LU04;51.6;TH;60.9WH4;I609WH4004450414046401006;39;P1_F_035;23-L449574;22.01.2027
;;000105287;;5:16;;;;;;60.9WH4;I609WH4004450414046401007;39;P1_F_029;23-L449574;22.01.2027
Komerc;103390988;000105137;16.02.2026 21:53:48;21:05;New;Started;LU03;1500000;PC;45.V626;L23-55121129999996950;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996951;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996952;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996953;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996954;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996955;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996956;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996957;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996958;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996959;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996960;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996961;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996962;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996963;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996964;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996965;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996966;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996967;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996968;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996969;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996970;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996971;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996972;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996973;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996974;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996975;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996976;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996977;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996978;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996979;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996980;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996981;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996982;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996983;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996984;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996985;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996986;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996987;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996988;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996989;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996990;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996991;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996992;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996993;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996994;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996995;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996996;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996997;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996998;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999996999;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997000;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997001;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997002;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997003;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997004;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997005;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997006;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997007;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997008;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997009;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997010;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997011;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997012;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997013;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997014;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997015;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997016;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997017;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997018;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997019;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997020;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997021;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997022;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997023;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997024;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997025;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997026;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997027;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997028;67500;Banderole;23-5512112;18.07.2026
;;000105137;;21:05;;;;;;45.V626;L23-55121129999997029;67500;Banderole;23-5512112;18.07.2026
`;

    let isFocused = false;

    function getTimeStyle(timeStr) {
        if (!timeStr || !timeStr.includes(':')) return { bg: '#fff', text: '#000' };
        const parts = timeStr.split(':');
        const total = (parseInt(parts[0]) * 60) + parseInt(parts[1]);
        if (total < 15) return { bg: '#ffffff', text: '#000000' };
        if (total <= 24) return { bg: '#ffff00', text: '#000000' };
        if (total <= 240) return { bg: '#ff0000', text: '#ffffff' };
        return { bg: '#000000', text: '#ffffff' };
    }

    function build() {
        const lines = rawData.trim().split('\n');
        const headers = lines[0].split(';');
        const rows = lines.slice(1);
        const body = document.getElementById('mainBody');

        const mainIdx = [4, 6, 7, 10, 12, 13];
        const extraIdx = [0, 1, 2, 3, 4, 5, 8, 9];
        const detailIdx = [10, 11, 12, 13, 14, 15];

        const groups = {};
        rows.forEach(line => {
            const cols = line.split(';');
            const id = cols[2];
            if (!groups[id]) groups[id] = [];
            groups[id].push(cols);
        });

        Object.keys(groups).forEach((id, index) => {
            const dataRows = groups[id];
            const first = dataRows[0];
            const tStyle = getTimeStyle(first[4]);
            const rowClass = (index % 2 === 0) ? 'row-type-1' : 'row-type-2';

            const masterTr = document.createElement('tr');
            masterTr.className = `master-row ${rowClass}`;
            masterTr.id = `master-${id}`;
            masterTr.innerHTML = `
                <td style="background:${tStyle.bg}; color:${tStyle.text}">${first[4]}</td>                
               
                <td class="st-cell st-${first[6].toLowerCase()}  ${first[5] !== 'New' ? 'st-picking' : ''}"> ${first[5] !== 'New' ? first[5] : first[6]}</td>
                ${first[5] == 'Picking' ? `<td class="st-picking">${first[7]}</td><td class="st-picking">${first[10]}</td><td class="st-picking">${first[12]}</td><td class="st-picking">${first[13]}</td>` : ``} 
                ${first[5] == 'Picked'  ? `<td class="st-picked">${first[7]}</td><td class="st-picked">${first[10]}</td><td class="st-picked">${first[12]}</td><td class="st-picked">${first[13]}</td>` : ``} 
                ${first[5] == 'New'     ? `<td>${first[7]}</td><td>${first[10]}</td> <td>${first[12]}</td> <td>${first[13]}</td>` : ``} 
                `;

            const detailTr = document.createElement('tr');
            detailTr.className = 'detail-row';
            detailTr.id = `detail-${id}`;
            
            const extraHeader = extraIdx.map(i => `<th>${headers[i]}</th>`).join('');
            const extraData = extraIdx.map(i => `<td>${first[i]}</td>`).join('');
            const innerHeader = detailIdx.map(i => `<th>${headers[i]}</th>`).join('');
            const innerRows = dataRows.map(r => `<tr>${detailIdx.map(i => `<td>${r[i]}</td>`).join('')}</tr>`).join('');

            detailTr.innerHTML = `
                <td colspan="6" class="detail-cell">
                    <table class="extra-table"><thead><tr>${extraHeader}</tr></thead><tbody><tr>${extraData}</tr></tbody></table>
                    <div class="scroll-wrapper">
                        <table class="inner-table">
                            <thead><tr>${innerHeader}</tr></thead>
                            <tbody>${innerRows}</tbody>
                        </table>
                    </div>
                </td>`;

            masterTr.onclick = () => isFocused ? reset() : focusOrder(id);
            body.appendChild(masterTr);
            body.appendChild(detailTr);
        });
    }

    function focusOrder(id) {
        isFocused = true;
        // Nagłówek (#mainHeader) pozostaje widoczny (nie zmieniamy display)
        document.querySelectorAll('.master-row').forEach(r => r.style.display = 'none');
        document.getElementById(`master-${id}`).style.display = 'table-row';
        document.getElementById(`detail-${id}`).style.display = 'table-row';
        window.scrollTo(0,0);
    }

    function reset() {
        isFocused = false;
        document.querySelectorAll('.master-row').forEach(r => r.style.display = 'table-row');
        document.querySelectorAll('.detail-row').forEach(r => r.style.display = 'none');
    }

    window.onload = build;
// *********************************** refresh
   let lastInteractionTime = Date.now();

    // 1. Rejestrujemy każde kliknięcie w tabelę, aby zresetować licznik 15s
    document.addEventListener('click', function(e) {   if (e.target.closest('.extra-table, .inner-table, .detail-row')) {    lastInteractionTime = Date.now();   }  });

    // 2. Funkcja zarządzająca odświeżaniem
    function manageRefresh() {
        const now = Date.now();
        const timeSinceInteraction = now - lastInteractionTime;        
        if (typeof isFocused !== 'undefined' && isFocused === false) { location.reload();  }  // SCENARIUSZ 1: Tabela zwinięta (isFocused === false) -> Odświeżamy natychmiast         
        else if (timeSinceInteraction >= 120000) {   location.reload(); }                      // SCENARIUSZ 2: Tabela rozwinięta (isFocused === true) -> Czekamy na 120s bezruchu       
        else { setTimeout(manageRefresh, 5000); }
    }
    setTimeout(manageRefresh, 60000);                                                         // 3. Start sprawdzania po 60 sekundach od załadowania strony
// **************************************** full screen
        document.addEventListener("click", function() { document.documentElement.requestFullscreen(); }, { once: true });
</script>
</body>
</html>

